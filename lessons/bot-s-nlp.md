---
description: >-
  В этом уроке вы узнаете, как с помощью Metabot24 создать бот с распознаванием
  естественного языка и протестировать его в Telegram.
---

# Бот с NLP

### Введение

Чат-бот с применением технологии NLP может стать отличным дополнением в команду. Он выступит заслоном и фильтром обращений, разгрузит специалистов контакт-центра и при этом улучшит клиентский сервис за счет моментальной помощи в режиме 24/7. Если же вы работаете сами, благодаря чат-боту вы сможете высвободить массу времени и будете меньше отвлекаться.

Чат-боты и виртуальные консультанты на технологии NLP способны поддерживать диалог с людьми на естественном языке, обрабатывать возражения, переключаться между ветками диалога, отвечать на контекстно зависимые вопросы.

Наибольшую выгоду от внедрения чат-бот создает на больших количествах обращений – ведь чат-бот это инструмент автоматизации для масштабирования бизнеса.

В этом уроке вы узнаете, как без глубоких знаний и навыков программирования в кратчайшие сроки можно создать чат-бота с применением технологии NLP и внедрить его в работу на этапе первого касания, на который приходится больше всего обращений в бизнесе.

Созданный вами бот первого касания с распознаванием естественного языка (NLP), станет отличным решением для автоматизации вашей службы поддержки, а также для применения в продажах.

Вы сможете обучить чат-бота отвечать на вопросы с применением технологии обработки естественного языка на базе Dialogflow от Google (NLP).

{% hint style="info" %}
Обработка естественного языка (Natural Language Processing, NLP) — общее направление искусственного интеллекта и математической лингвистики. Оно изучает проблемы компьютерного анализа и синтеза естественных языков. Применительно к искусственному интеллекту анализ означает понимание языка, а синтез — генерацию грамотного текста. Решение этих проблем будет означать создание более удобной формы взаимодействия компьютера и человека. Источник: [Wikipedia/NLP](https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0\_%D0%B5%D1%81%D1%82%D0%B5%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE\_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B0)
{% endhint %}

{% hint style="info" %}
Мы запланировали функцию самостоятельного создания бота из шаблона, а пока готовый шаблон бота из этого урока вы можете запросить у нашей поддержки через удобный вам канал связи на странице [Помощь](https://app.metabot24.com/help).
{% endhint %}

{% hint style="warning" %}
Если вам нужна помощь с созданием и внедрением чат-бота в ваш бизнес, вы всегда можете воспользоваться нашими услугами. Для этого свяжитесь с нами через удобный вам канал связи на странице [Помощь](https://app.metabot24.com/help).
{% endhint %}

{% embed url="https://youtu.be/_NpUJEqsGEI" %}

### Структура урока

Данный урок состоит из двух частей:

* в первой части урока вы узнаете, как на платформе Metabot создать типовой бот с применением NLP технологии, который будет способен распознавать намерение пользователя и стартовать подходящий сценарий поведения;
* во второй части мы покажем вам, как интегрировать Dialogflow для распознавания намерений, обучить модель в Dialogflow и связать намерения в Dialogflow с ответами в Metabot.

Итак, приступим к первой части нашего урока - к созданию логики бота.

### Создание бота

1. [Зарегистрируйтесь](https://app.metabot24.com/register) на платформе Metabot24, подтвердите электронную почту. Далее войдите в аккаунт.
2. [Создайте](https://app.metabot24.com/bot/create) нового бота, нажав кнопку _**Создать нового...**_

{% hint style="info" %}
&#x20;Рекомендуем также ознакомиться с подробным описанием [Как создать бота](https://metabot.gitbook.io/documentation/nachat-rabotu-s-metabot24/kak-sozdat-bota).
{% endhint %}

* Укажите название бота. Например: "NLP бот продажи услуг";
* Не устанавливаем опцию _Включить обнаружение NLP в приветствии_;
* Не устанавливаем опцию _Включить обнаружение NLP Action в приветствии;_
* Нажмите кнопку _**Создать**._

![](<../.gitbook/assets/izobrazhenie (208).png>)

3\. [Создайте](https://app.metabot24.com/status/create) статусы, нажав на кнопку **Создать статус** в разделе **Настройки бота ->** [**Статусы**](https://app.metabot24.com/status).

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием[ Статусы](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/statusy).
{% endhint %}

В рамках данного урока создадим два статуса: _Первичное касание, Диалог с оператором_.

* Введите первый статус _**Первичное касание**_ - он будет присвоен Лиду при первом запуске бота.

![](<../.gitbook/assets/izobrazhenie (1).png>)

* Аналогичным способом создадим второй статус _**Диалог с оператором**_ - он будет присвоен Лиду, если он заказал услугу или позвал оператора.

![](<../.gitbook/assets/izobrazhenie (104).png>)

4\. [Создайте](https://app.metabot24.com/sentence/create) новый скрипт в вашем боте, нажав на кнопку _**Создать**  **скрипт**_ в разделе **Настройки бота** -> **** [**Скрипты**](https://app.metabot24.com/menubuilder).

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием[ Скрипты](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/skripty).
{% endhint %}

* Укажите название скрипта. Например: "Приветствие";
* Остальные параметры без изменения.

![Создание скрипта "Приветствие"](<../.gitbook/assets/izobrazhenie (80).png>)

* Далее откройте редактор скрипта, нажав на кнопку _Перейти в редактор скрипта_**,** расположенную напротив только что созданного вами скрипта.

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Редактор скрипта](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/skripty/redaktor-skripta).
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (315).png>)

* Добавьте команду _**Отправить текст**_, нажав на кнопку _**Добавить команду**_ и выбрав ее в открывшемся окне. Напишите текст сообщения. Текст может содержать эмодзи для эмоционального окраса вашего приветствия.

![](<../.gitbook/assets/izobrazhenie (182).png>)

* Добавьте команду _**Установить статус лида**_, в которой при начале общения с ботом пользователю будет установлен статус, например, "Первичное касание".

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Установить статус лида](https://metabot.gitbook.io/documentation/komandy/ustanovit-status-lida).
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (372).png>)

5\. Теперь мы создадим еще несколько скриптов по аналогии с пунктом 3. Всего в рамках этого урока нам необходимо создать следующие скрипты:

* Задать NLP вопрос - в этом скрипте бот будет получать вопрос от пользователя и отправлять его в Dialogflow на распознавание;
* Заказать услугу - это сценарий поведения бота для приема заявок на услугу и переключение на оператора для отработки заявки;
* 👨‍🔧 Позовите оператора - выполнение данного скрипта подразумевает переключение на оператора;
* Способы оплаты - ответ на вопрос пользователя;
* Часы работы - ответ на вопрос пользователя;
* Позвать бота - скрипт необходим, когда пользователь позвал оператора, но потом передумал и хочет продолжить общение с ботом;
* 🛑 Не корректный ввод - скрипт, который бот выполняет, когда не распознано намерение пользователя.

Ниже рекомендации по созданию данных скриптов.

{% hint style="info" %}
Как выполнить интеграцию с соответствующим намерением из базы знаний в DF, рекомендуем  ознакомиться в разделах [Интеграция с Dialogflow](https://metabot.gitbook.io/documentation/dialogflow/integraciya-s-dialogflow) и [Обучение бота](https://metabot.gitbook.io/documentation/dialogflow/obuchenie-bota).
{% endhint %}

{% hint style="warning" %}
Рекомендуем Намерения DF называть одноименно со скриптами вашего сценария. Если в наименовании Намерения содержится более 1 слова, то слова должны быть соединены знаком "\_".
{% endhint %}

Итак, приступим к созданию скриптов.

6\. [Создайте ](https://app.metabot24.com/sentence/create)новый скрипт с названием **Задать NLP вопрос:**

* Укажите название скрипта. Например: "Задать NLP вопрос";
* Установить опцию _Включить NLP_;
* Остальные параметры без изменения.

![](<../.gitbook/assets/izobrazhenie (383).png>)

* Далее откройте редактор скрипта, нажав на кнопку _Перейти в редактор скрипта_, расположенную напротив только что созданного скрипта.  Блок **Команды** оставляем пустым. В блоке **Меню** добавим пункт меню.

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Создание меню](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/skripty/sozdanie-menyu).
{% endhint %}

* Нажмите на кнопку _**Добавить пункт меню**_;
* В поле _Код_ укажите букву "а" и в фигурных скобках значение 300, например, а{300}. Это регулярное выражение обезопасит чат-бот от случайно введенного не заложенного в сценарии варианта, который может привести к остановке бота.

{% hint style="info" %}
а{300} - это означает, что пользователь должен ввести символ "а" триста раз, чтобы попасть в этот пункт меню
{% endhint %}

\
Однако, поскольку мы включили опцию _Включить NLP_ у скрипта, то ввод от пользователя в первую очередь будет отправлен в DF для распознавания намерения и только в случае, если намерение не будет найдено, ввод от пользователя будет использован для поиска пункта меню с соответствующим кодом.

{% hint style="warning" %}
Так сейчас работает интеграция с NLP-машиной на платформе Metabot. Если в скрипте включена опция NLP, то при достижении меню ввод от пользователя вначале проверяется в базе знаний NLP и только потом по меню.
{% endhint %}

* Установить опцию _Скрыть код;_
* В поле _Подпись пункта меню_ укажите, например, фразу  "Что бы вы хотели узнать?";
* Не устанавливать опцию _Скрыть весь пункт меню_

{% hint style="warning" %}
**Внимание!** Именно для того, чтобы логика распознавания намерения вначале проверялась в базе знаний NLP, можно установить у пункта меню опцию _Скрыть весь пункт меню_. Таким образом меню будет существовать в логике, но не видно на экране.&#x20;

"Заглушка" в виде a{300} означает, что работает только NLP распознавание по базе и пользователь никогда не попадет в пункт меню.
{% endhint %}

* В качестве скрипта, выберите из списка созданный скрипт _Приветствие._

![](<../.gitbook/assets/izobrazhenie (238).png>)

![](<../.gitbook/assets/izobrazhenie (231).png>)

7\. Вернемся к редактированию скрипта **Приветствие** и в редакторе скрипта добавим команду _**Выполнить скрипт**_.

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Выполнить скрипт](https://metabot.gitbook.io/documentation/komandy/vypolnit-stript).
{% endhint %}

* В качестве скрипта, выберите из списка созданный скрипт __ **Задать NLP вопрос**_._

![](<../.gitbook/assets/izobrazhenie (255).png>)

{% hint style="warning" %}
**Внимание!** Обращаем ваше внимание на то, что теперь после приветствия пользователя мы перебросим его в скрипт, где зададим невидимый вопрос и будем ждать ввода, а ввод в свою очередь попадет в NLP т.к. у скрипта **Задать NLP вопрос** активирована NLP-машина.
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (60).png>)

8\. [Создайте](https://app.metabot24.com/sentence/create) новый скрипт с названием **Заказать услугу**. Выполнение данного скрипта подразумевает не только ответ на вопрос пользователя, но и переключение на оператора.

* Укажите название скрипта. Например: "Заказать услугу";
* Установить интеграцию с намерением в поле _NLP намерение_ - установить значение _**заказать\_услугу**_;
* Остальные параметры без изменения.

{% hint style="info" %}
Как выполнить интеграцию с соответствующим намерением из базы знаний в DF, рекомендуем  ознакомиться в разделах [Интеграция с Dialogflow](https://metabot.gitbook.io/documentation/dialogflow/integraciya-s-dialogflow) и [Обучение бота](https://metabot.gitbook.io/documentation/dialogflow/obuchenie-bota).
{% endhint %}

{% hint style="warning" %}
**Внимание!** Обращаем ваше внимание на логику работы NLP, а именно на то, что когда намерение в Dialogflow найдено, оно ищется по базе скриптов, используя поле _NLP Намерение_ по полному совпадению.&#x20;

Если ни одного совпадения не найдено, то загрузится заглушка скрипт **Не корректный ввод** с типом _Fallback._
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (235).png>)

Скрипт **Заказать услугу** может содержать одну или несколько команд:&#x20;

*   Добавьте команду _**Отправить текст**_, например,&#x20;

    | <p>👋 Я Ваш личный бот-помощник и я готов принять Ваш заказ прямо сейчас! 🤖</p><p>👉 Просто ответьте на мои вопросы.</p> |
    | ------------------------------------------------------------------------------------------------------------------------- |

Далее добавим две различные команды **Запросить значение**, которые будут запрашивать у пользователя его контактные данные и предпочитаемый способ оплаты, далее эти данные будут фиксироваться в карточке пользователя. Например, запросим следующие значения:&#x20;

*   Добавьте команду _**Запросить значение**_**.**&#x20;

    * Имя переменной - значение переменной указывается латинскими буквами. Если переменная состоит из нескольких слов, то слова разделяются знаком подчеркивания "\_"**.** Например, order\_personal.

    Имя переменной  - укажите **order\_personal**.

    * Подсказка-приглашение для пользователя - произвольный текст понятный для пользователя, что он должен указать, например, "Одним сообщением укажите Ваши данные (ФИО, адрес, индекс и номер телефона) и какую услугу Вы хотите заказать 👇"

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Запросить значение](https://metabot.gitbook.io/documentation/komandy/zaprosit-znachenie).
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (175).png>)

*   Добавьте команду _**Запросить значение**_**.**&#x20;

    * Имя переменной - значение переменной указывается латинскими буквами. Если переменная состоит из нескольких слов, то слова разделяются знаком подчеркивания "\_"**.** Например, order\_payment.

    Имя переменной  - укажите **order\_payment**.

    * Подсказка-приглашение для пользователя - произвольный текст понятный для пользователя, что он должен указать, например, "Укажите способ оплаты (наложенный платёж или предоплата). 👇"

![](<../.gitbook/assets/izobrazhenie (406).png>)

* Добавьте команду _**Установить статус лида**_, например, статус "Диалог с оператором".&#x20;

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Установить статус лида](https://metabot.gitbook.io/documentation/komandy/ustanovit-status-lida).
{% endhint %}

* Добавьте команду _**Отправить текст**_, например, "Спасибо! Ваш заказ принят в обработку 🤩. Наши менеджеры работают каждый день с 9:30 до 21:30 и ответят Вам в этот промежуток времени".&#x20;
* Добавьте команду _**Стоп**_.&#x20;

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Стоп](https://metabot.gitbook.io/documentation/komandy/stop).
{% endhint %}

![Состав команд в скрипте "Заказать услугу"](<../.gitbook/assets/izobrazhenie (286).png>)

9\. [Создайте](https://app.metabot24.com/sentence/create) новый скрипт с названием **Позовите оператора**. Выполнение данного скрипта подразумевает переключение на оператора.

{% hint style="warning" %}
**Внимание!** Как видим из примера выше, передача на оператора реализована с помощью смены статуса заявки в CRM на статус _Диалог с оператором_. Используйте статус, на который бот не реагирует.
{% endhint %}

* Укажите название скрипта. Например: "Позовите оператора";
* Установить интеграцию с намерением в поле _NLP намерение_ - установить значение _**позовите\_оператора**_;
* Остальные параметры без изменения.

![](<../.gitbook/assets/izobrazhenie (311).png>)

Скрипт **Позовите оператора** должен содержать несколько команд, для этого в редакторе скрипта создадим команды:&#x20;

* Добавьте команду **Отправить текст**, в которой вы опишите дальнейшие действия пользователя и например, график работы специалистов;
* Добавьте команду **Установить статус лида**, в которой будет установлен статус, например, "Диалог с оператором";
* Добавьте команду **Стоп**.&#x20;

![](<../.gitbook/assets/izobrazhenie (310).png>)

10\. [Создайте](https://app.metabot24.com/sentence/create) новые скрипты **Способы оплаты** и **Часы работы,** которые должны быть интегрированы с соответствующими намерениями в DF и могут содержать одну или несколько команд:&#x20;

* Создайте скрипты, указав в поле _NLP намерение_ соответствующие намерение из DF.

![](<../.gitbook/assets/izobrazhenie (327).png>)

* Далее в редакторе скрипта добавьте команду _**Отправить текст**_;
* Добавьте команду _**Выполнить скрипт**_, в качестве скрипта укажите скрипт **Задать NLP вопрос**.

![](<../.gitbook/assets/izobrazhenie (177).png>)

![](<../.gitbook/assets/izobrazhenie (362).png>)

11\. [Создайте](https://app.metabot24.com/sentence/create) новый скрипт **Позвать бота**, который будет возобновлять работу чат-бота в том случае, если пользователь остановил его**.**&#x20;

{% hint style="warning" %}
**Внимание!** Не включайте NLP. В данном скрипте мы не используем механизм NLP-машины. Здесь используется внутренний механизм маршрутов и ключевых слов для реакции на слово "Бот", описание будет показано ниже в разделе "Создание маршрутов".
{% endhint %}

* Укажите название бота. Например: "Позвать бота";
* Остальные опции оставьте без изменений.

![](<../.gitbook/assets/izobrazhenie (170).png>)

* Далее в редакторе скрипта добавьте команду _**Установить статус лида**_. В данной команде необходимо перевести пользователя в первоначальный статус, например, "Первичное касание";
* &#x20;Добавьте команду _**Отправить текст**_, в которой вы уведомите пользователя о том, что с ним снова общается бот. Например, текст "Я здесь, с вами снова общается Бот.";
* Добавьте команду _**Выполнить скрипт**_**,** в которой произойдет распознавание NLP намерения, в качестве скрипта укажем созданный скрипт **Задать NLP вопрос**_._

![](<../.gitbook/assets/izobrazhenie (38).png>)

12\. [Создайте](https://app.metabot24.com/sentence/create) последний скрипт в вашем боте, который будет выполняться в том случае, если пользователь ввел вопрос/намерение или фразу не заложенные в базе знаний вашего бота**.**&#x20;

* Укажите название скрипта. Например: "🛑 Не корректный ввод";
* Тип скрипта - _Fallback_. Подробнее можно ознакомиться в разделе [Скрипты](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/skripty).
* Остальные параметры без изменения.

![](<../.gitbook/assets/izobrazhenie (243).png>)

* Далее в редакторе скрипта добавьте команду _**Отправить текст**_. В данной команде необходимо сообщить пользователю, что его запрос не распознан и порекомендовать его перефразировать, например, "Извините не понял 🤷‍♂️. Сформулируйте свой вопрос по-другому.";
* Добавьте команду _**Повторить вопрос**_.

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Повторить вопрос](https://metabot.gitbook.io/documentation/komandy/povtorit-vopros).
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (254).png>)

{% hint style="success" %}
Если вы все сделали правильно, согласно нашего урока, то получите следующий результат наполнения вашего бота основными скриптами.
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (382).png>)

Основные скрипты для работы бота созданы, далее рассмотрим создание маршрутов для взаимодействия бота с пользователями.

### Создание маршрутов

[Создайте](https://app.metabot24.com/route/create) маршруты для взаимодействия бота с пользователями, нажав на кнопку _**Создать маршрут**_ в разделе **Настройки бота ->** [**Маршруты**](https://app.metabot24.com/route)**.**

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Маршруты](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/marshruty).
{% endhint %}

1\. [Создайте](https://app.metabot24.com/route/create) маршрут, который будет запускаться для приветствия.

* Введите параметры, как показано на изображении ниже;
* В качестве _Названия_ укажите "Приветствие";
* В качестве скрипта, выберите скрипт **Приветствие**;
* В _Регулярном выражении_ слитно напишите точка-звездочка ".\*" без кавычек. Это выражение означает, что бот будет реагировать на любой текст от пользователя;
* В качестве _Статуса_ выберите ранее созданный статус **Первичное касание**.

![](<../.gitbook/assets/izobrazhenie (282).png>)

2\. [Создайте](https://app.metabot24.com/route/create) маршрут, который будет запускаться при вызове бота и скрипта **Позвать бота**.

* Введите параметры как показано на изображении ниже;
* В качестве _Названия_ укажите "Позвать бота";
* В качестве скрипта, выберите скрипт **Позвать бота**;
* В _Регулярном выражении_ напишите слово "бот". Это выражение означает, что бот будет реагировать на ввод текста "бот" от пользователя;
* В качестве _Статуса_ выберите ранее созданный статус **Диалог с оператором**.

![](<../.gitbook/assets/izobrazhenie (277).png>)

{% hint style="success" %}
Если вы все сделали правильно, согласно нашего урока, то получите следующий результат наполнения вашего бота маршрутами.
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (178).png>)

Резюмируем. Мы создали два маршрута, однако, напомним, что скриптов всего 8. Один из них Fallback на случай не верного ввода, для двух мы сделали маршруты, а в оставшиеся 5 мы будем попадать при помощи распознавания намерения NLP.

Приступим ко второй части нашего урока - созданию базы знаний и модели Dialogflow.

### База знаний / Dialogflow

{% hint style="info" %}
Напомним, что мы запланировали функцию самостоятельного создания бота из шаблона, а пока готовый шаблон бота из этого урока вы можете запросить у нашей поддержки через удобный вам канал связи на странице [Помощь](https://app.metabot24.com/help).
{% endhint %}

Для полноценной работы чат-бота с распознаванием намерений пользователя необходимо создать и настроить базу знаний, по запросам к которой бот будет давать правильные ответы и выстраивать логику взаимодействия с пользователем.&#x20;

Для работы нам понадобится сервис Dialogflow и чтобы им воспользоваться необходимо иметь аккаунт Google.

{% hint style="info" %}
Как выполнять регистрацию и интеграцию с соответствующим намерением из базы знаний в DF рекомендуем ознакомиться в разделах [Регистрация в Dialogflow](https://metabot.gitbook.io/documentation/dialogflow/registraciya-v-dialogflow) и [Интеграция с Dialogflow](https://metabot.gitbook.io/documentation/dialogflow/integraciya-s-dialogflow).
{% endhint %}

1. &#x20;Выполните авторизацию на сервисе Dialogflow.
2. &#x20;Перейдите в консоль учетной записи, нажав кнопку **Go to console.**
3. Нажмите на кнопку **Create New Agent** и создайте новый проект/агента, например, **NLP\_бот**.

![](<../.gitbook/assets/izobrazhenie (204).png>)

4\. После авторизации на сервисе Dialogflow и создании нового _Проекта/ Агента_ дальнейшая работа по обучению бота будет производиться в разделе **Intents.**

5\. Создаем Намерения, с помощью которых бот сможет распознавать текстовые запросы пользователя и подбирать правильные ответы из базы знаний.

{% hint style="info" %}
Как выполнять обучение бота соответствующим намерениям из базы знаний в DF рекомендуем ознакомиться в разделе [Обучение бота](https://metabot.gitbook.io/documentation/dialogflow/obuchenie-bota).
{% endhint %}

6\. Создаем Намерения, с помощью которых бот сможет распознавать текстовые запросы пользователя и подбирать правильные ответы из базы знаний. По кнопке _**Create Intent**_ создаем новое намерение**.**

Мы создали бота с 4 скриптами, в которых указана интеграция с базой знаний. Создаем 4 намерения для каждого скрипта соответственно:

* Заказать\_услугу;
* Позовите\_оператора;
* Способы\_оплаты;
* Часы\_работы.

{% hint style="warning" %}
**Внимание!** При обучении бота, чем больше вы введете однородных по смыслу запросов и синонимов ключевых слов, тем более точнее ваш бот будет понимать ваших пользователей.
{% endhint %}

В раздел **Training phrases** надо добавить различные варианты на тему того, что могут написать пользователи.

![](<../.gitbook/assets/izobrazhenie (199).png>)

{% hint style="warning" %}
**Внимание!** Так же при обучении бота намерению важно стараться не допускать фраз, которые могут повторяться в соседних намерениях, иначе бот из базы знаний может выбрать некорректный ответ.
{% endhint %}

Применение вариантов с перестановкой слов приветствуется. Знаки вопроса и прочие знаки препинания здесь прописывать не нужно.

В процессе обучения бота нужно проверять правильность вводимых значений. Для этого, в поле _Try it now_ необходимо указать один из введенных вариантов обращения и система должна предоставить ссылку на нужное намерение. Например, при варианте вопроса "До скольки вы открыты" выдается намерение "Часы\_работы".

![](<../.gitbook/assets/izobrazhenie (245).png>)

После ввода всех вариантов возможных обращение необходимо сохранить намерение, нажав на кнопку _Save._

{% hint style="warning" %}
**Внимание!** Советуем поставить себя на место ваших пользователей и проявить воображение, а также настоятельно рекомендуем изучить конкретные переписки с настоящими пользователями и посмотреть что они пишут.

И не переживайте, если не учтете все вариации. Не возможно сходу учесть все варианты сразу. И поверьте, пользователи вас будут периодически удивлять неожиданными формулировками.
{% endhint %}

Итак, обучите четыре намерения, например, так как показано на картинках ниже.

![Настройка намерения "Заказать услугу"](<../.gitbook/assets/izobrazhenie (107).png>)

![Настройка намерения "Позовите оператора"](<../.gitbook/assets/izobrazhenie (264).png>)

![Настройка намерения "Способы оплаты"](<../.gitbook/assets/izobrazhenie (203).png>)

![Настройка намерения "Часы работы"](<../.gitbook/assets/izobrazhenie (249).png>)

Интеграция скриптов в Metabot с намерениями из DF была произведена ранее при создании скриптов. Теперь можно встраивать в бота каналы по обмену сообщениями.

* В разделе **Настройки бота** выбрать пункт [**Интеграции**](https://app.metabot24.com/bot-integration)**.**
* [Создать](https://app.metabot24.com/bot-integration/create) новую интеграцию, нажав на кнопку **Новая привязка**.

![](<../.gitbook/assets/izobrazhenie (146).png>)

{% hint style="warning" %}
Интегрируйте Dialogflow с Metabot, используя эту инструкцию [Интеграция с Dialogflow](https://metabot.gitbook.io/documentation/dialogflow/integraciya-s-dialogflow).
{% endhint %}

* В диалоговом окне заполнить следующие параметры:
  * _Интеграционная система_ - выбрать из списка Dialogflow;
  * _Авторизационный ключ (json)_ - из буфера обмена скопировать полностью текст закрытого ключа;
  * _Токен_ - параметр остается не заполненным;
  * Нажать кнопку _**Создать**_.

![](<../.gitbook/assets/izobrazhenie (185).png>)



* В разделе [**Интеграции с ботом**](https://app.metabot24.com/bot-integration) располагается список всех настроенных интеграционных привязок для данного бота.

![](<../.gitbook/assets/izobrazhenie (10).png>)

{% hint style="warning" %}
Для интеграции с каналами от Umnico, воспользуйтесь инструкцией [Бот на базе Umnico](https://metabot.gitbook.io/documentation/lessons/bot-na-baze-umnico).
{% endhint %}

### Запуск бота в Telegram

1. Создайте бот в Telegram при помощи **@BotFather** и скопируйте токен.

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием [Интеграция канала Telegram](https://metabot.gitbook.io/documentation/podklyuchenie-kanalov/telegram).
{% endhint %}

&#x20;  2\. [Создайте](https://app.metabot24.com/bot-channel/create) новый канал в Metabot в разделе **Настройки бота ->** [**Каналы**](https://app.metabot24.com/bot-channel), нажав на кнопку _**Новая привязка**._

{% hint style="info" %}
Рекомендуем также ознакомиться с подробным описанием[ ](https://metarex.gitbook.io/metabot24/podklychenie-kanal/telegram)[Каналы](https://metabot.gitbook.io/documentation/panel-upravleniya-botom/kanaly).
{% endhint %}

* Выберите Telegram в качестве Канала;
* Скопируйте токен, полученный на предыдущем шаге;
* Нажмите **Создать**, чтобы сохранить настройки.

{% hint style="warning" %}
Нажмите **Вебхук**, чтобы установить связь канала и вашим ботом. Не пропустите этот шаг!
{% endhint %}

### Взаимодействие с ботом <a href="#vzaimodeistvie-s-botom" id="vzaimodeistvie-s-botom"></a>

Далее перейдите в приложение Telegram, откройте ваш бот и нажмите кнопку **Запустить/Start**. Если вы все сделали правильно, ваш бот поприветствует вас.&#x20;

Далее задайте любой вопрос.

{% hint style="success" %}
Если вы все сделали правильно, согласно нашего урока, то увидите следующую картину.
{% endhint %}

![](<../.gitbook/assets/izobrazhenie (219).png>)

{% hint style="success" %}
Поздравляем вас с созданием вашего бота c NLP на платформе Метабот24!
{% endhint %}

Попробовать в действии бот, который был описан в данном уроке можно, набрав в Telegram логин **@urok1\_nlp\_bot**.

{% hint style="warning" %}
**Внимание!** Если у вас возникли затруднения с прохождением этого урока, вы можете обратиться в нашу поддержку. Вы также можете установить готовый шаблон из этого урока, запросив его в поддержке через удобный вам канал связи на странице [Помощь](https://app.metabot24.com/help).
{% endhint %}

### Следующие шаги

Воспользуйтесь следующим уроком для решения ваших бизнес-задач:

* [Создать бот с меню самообслуживания](https://metabot.gitbook.io/documentation/lessons/bot-s-menyu-samoobsluzhivaniya).
